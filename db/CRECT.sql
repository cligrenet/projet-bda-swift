   SET CURRENT SQLID=USER;

-----
-------------SUPPRESSION DU TABSPACE
-------------SI-204 METTRE EN COMMENTAIRES LES DROP
-- DROP TABLESPACE ADSDB01.ADSAC01;
-- COMMIT;
-----
-------------CREATION DU TABSPACE
   CREATE TABLESPACE ADSAC01
       IN ADSDB01
       USING STOGROUP ADSST01
       PRIQTY 80
       SECQTY 80;
-----
     COMMIT;
--
  CREATE TABLE CT_STATUT
    (STATUT           CHAR(1) NOT NULL,
     LIBSTAT          CHAR(15) NOT NULL,
  PRIMARY KEY (STATUT))
  IN ADSDB01.ADSAC01;
  CREATE UNIQUE INDEX IXSTATUT ON CT_STATUT(STATUT)
  USING STOGROUP ADSST01;
  COMMIT;

  INSERT INTO CT_STATUT VALUES ('E','EN COURS');
  INSERT INTO CT_STATUT VALUES ('P','PROSPECT');
  INSERT INTO CT_STATUT VALUES ('O','OUVERT');
  INSERT INTO CT_STATUT VALUES ('B','BLOQUE');
  INSERT INTO CT_STATUT VALUES ('F','FERME');
  COMMIT;

--
  CREATE TABLE CT_CLIENT
    (NUMCLI           INTEGER  NOT NULL,
     STATUT           CHAR(1)  NOT NULL,
     NOM000           CHAR(15) NOT NULL,
     PRENOM           CHAR(15) NOT NULL,
     VILLE            CHAR(15),
     CDPOST           CHAR(5),
     DATENT           DATE     NOT NULL,
     DATMAJ           DATE     NOT NULL,
  PRIMARY KEY (NUMCLI),
  FOREIGN KEY (STATUT) REFERENCES CT_STATUT ON DELETE RESTRICT)
  IN ADSDB01.ADSAC01;
  CREATE UNIQUE INDEX IXCLIENT ON CT_CLIENT(NUMCLI)
  USING STOGROUP ADSST01;
  COMMIT;

  INSERT INTO CT_CLIENT VALUES
  (1,'E','DEBUSSY','CLAUDE','PARIS','75016','15.01.1999','15.01.2023');
  INSERT INTO CT_CLIENT VALUES
  (2,'E','BRASSENS','GEORGES','SETE','33000','30.12.2022','05.01.2023');
  INSERT INTO CT_CLIENT VALUES
  (3,'P','PAGNY','FLORENT','HUIT','56000','18.08.2014','15.01.2023');
  INSERT INTO CT_CLIENT VALUES
  (4,'E','DION','CELINE','VERSAILLES','78000','24.06.2009',
                                             '17.11.2022');
  COMMIT;

--
  CREATE TABLE CT_COMPTE
    (NUMCPT           INTEGER  NOT NULL,
     STATUT           CHAR(1)  NOT NULL,
     SOLDE            DECIMAL (11,2) NOT NULL,
     DATOUV           DATE     NOT NULL,
     DATMAJ           DATE     NOT NULL,
  PRIMARY KEY (NUMCPT),
  FOREIGN KEY (STATUT) REFERENCES CT_STATUT ON DELETE RESTRICT)
  IN ADSDB01.ADSAC01;
  CREATE UNIQUE INDEX IXCOMPTE ON CT_COMPTE(NUMCPT)
  USING STOGROUP ADSST01;
  COMMIT;

  INSERT INTO CT_COMPTE VALUES
  (1,'O',3240.53,'15.01.1999','15.01.2023');
  INSERT INTO CT_COMPTE VALUES
  (2,'B',8340.00,'24.10.2021','25.04.2022');
  INSERT INTO CT_COMPTE VALUES
  (3,'F',0,'07.09.1984','30.06.2010');
  INSERT INTO CT_COMPTE VALUES
  (4,'O',-536.00,'18.02.2020','14.01.2023');
  COMMIT;

--
  CREATE TABLE CT_CPTCLI
    (NUMCLI           INTEGER  NOT NULL,
     NUMCPT           INTEGER  NOT NULL,
  PRIMARY KEY (NUMCLI,NUMCPT),
  FOREIGN KEY (NUMCLI) REFERENCES CT_CLIENT ON DELETE RESTRICT,
  FOREIGN KEY (NUMCPT) REFERENCES CT_COMPTE ON DELETE RESTRICT)
  IN ADSDB01.ADSAC01;
  CREATE UNIQUE INDEX IXCPTCLI ON CT_CPTCLI(NUMCLI,NUMCPT)
  USING STOGROUP ADSST01;
  COMMIT;

  INSERT INTO CT_CPTCLI VALUES (1,1);
  INSERT INTO CT_CPTCLI VALUES (2,2);
  INSERT INTO CT_CPTCLI VALUES (3,3);
  INSERT INTO CT_CPTCLI VALUES (4,4);
  COMMIT;

--
  CREATE TABLE CT_OPER
    (NUMCPT           INTEGER  NOT NULL,
     NUMOPE           INTEGER  NOT NULL,
     TEXTE0           CHAR(80) NOT NULL,
     MTOPER           DECIMAL(11,2),
     DATEOP           DATE     NOT NULL,
  PRIMARY KEY (NUMCPT,NUMOPE),
  FOREIGN KEY (NUMCPT) REFERENCES CT_COMPTE ON DELETE RESTRICT)
  IN ADSDB01.ADSAC01;
  CREATE UNIQUE INDEX IXOPER   ON CT_OPER(NUMCPT,NUMOPE)
  USING STOGROUP ADSST01;
  COMMIT;

  INSERT INTO CT_OPER   VALUES
   (1,1,'RETRAIT',-50,'15.01.2023');
  INSERT INTO CT_OPER   VALUES
   (1,2,'VERSEMENT SALAIRE',3100.00,'29.12.2022');
  INSERT INTO CT_OPER   VALUES
   (1,3,'VIREMENT INTERNATIONAL',-500.00,'30.12.2022');
  INSERT INTO CT_OPER   VALUES
   (4,1,'CREDIT CONSO',-450.00,'30.12.2022');
  INSERT INTO CT_OPER   VALUES
   (4,2,'EMOLUMENTS CONCERT',100000.00,'29.12.2022');
  COMMIT;

  SELECT * FROM CT_STATUT;
  SELECT * FROM CT_CLIENT;
  SELECT * FROM CT_COMPTE;
  SELECT * FROM CT_CPTCLI;
  SELECT * FROM CT_OPER;
